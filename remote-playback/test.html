<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
        <title>An example for Remote Playback API</title>
        <style>
            p {margin-left:1-px; font-size:150%;}
        </style>
        <script>
            window.onload = function() {
                var promptBtn = document.getElementById('promptBtn');
                var availabilityText = document.getElementById('availabilityText');
                var remotePlaybackText = document.getElementById('remotePlaybackText');
                var videoElem = document.getElementById('videoElement');
                var deviceAvailability = false;
                var attributeBtn = document.getElementById('toggleDisableRemotePlaybackBtn');
                
                function handleAvailabilityChange(availability) {
                  deviceAvailability = availability;
                  updateAvailabilityText();
                };

                function updateAvailabilityText() {
                    availabilityText.innerHTML = deviceAvailability ? 'device available' : 'device unavailable';
                };
                
                function switchToRemoteUI () {
                    videoElem.style.display = 'none';
                    remotePlaybackText.style.display = 'inline';
                    if (videoElem.remote.state == 'connecting')
                        remotePlaybackText.innerHTML = 'Connecting to the remote device';
                    else
                        remotePlaybackText.innerHTML = 'Connected to the remote device';
                };

                var switchToLocalUI = function() {
                    videoElem.style.display = 'inline';
                    remotePlaybackText.style.display = 'none';
                };
              
                videoElem.remote.getAvailability().then(function(availability) {
                    handleAvailabilityChange(availability.value);
                    availability.onchange = function() {
                      handleAvailabilityChange(this.value);
                    };
                }).catch(function() {
                    handleAvailabilityChange(true);
                });
              
                promptBtn.onclick = function() {
                    videoElem.remote.prompt().then(switchToRemoteUI);
                };
                
                attributeBtn.onclick = function() {
                    if (videoElem.disableRemotePlayback) {
                        videoElem.disableRemotePlayback = null;
                        attributeBtn.innerHTML = 'Disable remote playback';
                    } else {
                        videoElem.disableRemotePlayback = true;
                        attributeBtn.innerHTML = 'Enable remote playback';
                    }
                }
              
                if (videoElem.remote.state != 'disconnected')
                    switchToRemoteUI();
                videoElem.remote.onstatechange = function(evt) {
                    if (videoElem.remote.state != 'disconnected')
                        switchToRemoteUI();
                    else
                        switchToLocalUI();
                };
            };
        </script>
    </head>
    <body>
        <p>
            A video element
            <br>
            <div>
                <video id="videoElement" disableRemotePlayback src="/sintel_trailer-480p.mp4" type="video/mp4"></video>
                <div id="availabilityText" style="display: none;"></div>
                <div id="remotePlaybackText" style="display: none;"></div>
            </div>
            <br>
            <button id="promptBtn">Prompt</button>
            <button id="toggleDisableRemotePlaybackBtn">Disable remote playback</button>
        </p>
    </body>
</html>
